<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Team Database</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
:root{
  --bg-light:#666769;
  --bg-dark:#1A252C;
  --card-light:#02491D;
  --card-dark:#023804;
  --title-color:#ffffff;
}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial,sans-serif}
body{background:var(--bg-light);color:#F0F0F0}
body.dark{background:var(--bg-dark)}

.mode-toggle{
  position:fixed;top:12px;right:12px;z-index:1200;
  background:rgba(255,255,255,0.9);color:#111;
  padding:6px 10px;border-radius:8px;cursor:pointer;
}
body.dark .mode-toggle{background:rgba(0,0,0,0.7);color:#F0F0F0}

.loader{
  min-height:100vh;display:flex;align-items:center;justify-content:center;
  flex-direction:column;gap:14px;text-align:center;
}
.loader img.logo{
  width:200px;height:200px;object-fit:cover;border-radius:50%;
  box-shadow:0 8px 24px rgba(0,0,0,0.25)
}
.loading-text{opacity:.85;font-size:.95rem}

.wrap{max-width:860px;margin:28px auto;padding:18px}
.card{
  border-radius:12px;padding:18px;
  background:var(--card-light);
}
body.dark .card{background:var(--card-dark)}

label{display:block;margin-top:10px;margin-bottom:6px}
select,button{
  width:100%;padding:10px;border-radius:8px;font-size:15px;
}
select{background:#F0F0F0}
body.dark select{background:#000;color:#fff}

.controls{display:flex;gap:10px;flex-wrap:wrap}
.controls button{width:auto}

.results{margin-top:14px;background:rgba(255,255,255,0.06);padding:14px;border-radius:8px}

.section-title{font-weight:600;margin:14px 0 6px}
.preview-img{
  max-width:220px;border-radius:8px;cursor:pointer;
  box-shadow:0 6px 18px rgba(0,0,0,0.3)
}

#imgOverlay{
  position:fixed;inset:0;background:rgba(0,0,0,0.9);
  display:none;align-items:center;justify-content:center;
  z-index:2000;
}
#imgOverlay img{max-width:90%;max-height:90%}
#imgOverlay .close{
  position:absolute;top:20px;right:20px;
  font-size:28px;cursor:pointer;color:#fff;
}
iframe{width:100%;aspect-ratio:16/9;border:none;border-radius:8px}
</style>
</head>

<body>

<!-- Dark Mode Toggle (nur im Haupt-Tool sichtbar) -->
<div id="modeToggle" class="mode-toggle" style="display:none">üåô Dark Mode</div>

<!-- Loading Screen -->
<div id="loading" class="loader">
  <img class="logo" src="https://i.imgur.com/XZcfQzw.png">
  <div id="loadingText" class="loading-text">Loading‚Ä¶</div>
</div>

<div id="app" class="wrap" style="display:none">
  <div class="card">
    <label>Content</label>
    <select id="contentSelect">
      <option value="">-- choose --</option>
    </select>

    <label>Team</label>
    <select id="teamSelect" disabled>
      <option value="">-- choose --</option>
    </select>

    <div class="controls">
      <button id="showBtn">Show</button>
      <button id="resetBtn">Reset</button>
    </div>

    <div id="out" class="results" style="display:none"></div>
  </div>
</div>

<div id="imgOverlay">
  <span class="close">‚úï</span>
  <img id="overlayImg">
</div>

<script>
const CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vTQXPCtdQMlebYXnrAn2uTY1o0Qkn9h1tZyOvVk0xPwL2Ig9p3XMGmKDqEfeJjpyQ97e8UrpaTzmnN3/pub?output=csv";
const $=id=>document.getElementById(id);
let rows=[];

/* ---------- LOAD DATA ---------- */
function loadData(){
 Papa.parse(CSV_URL,{
  download:true,header:true,skipEmptyLines:true,
  complete:r=>{
    rows=r.data;
    const contents=[...new Set(rows.map(x=>x.Content))];
    contents.forEach(c=>$('contentSelect').add(new Option(c,c)));
    $('loading').style.display='none';
    $('app').style.display='block';
    $('modeToggle').style.display='block';
  }
 });
}

/* ---------- SELECT HANDLING ---------- */
$('contentSelect').onchange=()=>{
 const val=$('contentSelect').value;
 const teamSel=$('teamSelect');
 teamSel.innerHTML='<option value="">-- choose --</option>';
 teamSel.disabled=!val;
 rows.filter(r=>r.Content===val)
     .forEach(r=>teamSel.add(new Option(r.Team,r.Team)));
};

function youtubeEmbed(url){
 try{
  const id=url.includes('youtu.be')
   ? url.split('/').pop()
   : new URL(url).searchParams.get('v');
  return id
   ? `<iframe src="https://www.youtube.com/embed/${id}" allowfullscreen></iframe>`
   : `<a href="${url}" target="_blank">${url}</a>`;
 }catch{return ''}
}

/* ---------- SHOW ---------- */
$('showBtn').onclick=()=>{
 const c=$('contentSelect').value;
 const t=$('teamSelect').value;
 const r=rows.find(x=>x.Content===c && x.Team===t);
 if(!r)return alert('Please select Content and Team');
 $('out').innerHTML=`
  <div class="section-title">Content</div>${r.Content}
  <div class="section-title">Preview</div>
  <img class="preview-img" src="${r.Preview}">
  <div class="section-title">Showcase</div>
  ${r.Showcase?youtubeEmbed(r.Showcase):''}
 `;
 $('out').style.display='block';

 document.querySelector('.preview-img').onclick=()=>{
  $('overlayImg').src=r.Preview;
  $('imgOverlay').style.display='flex';
 };
};

/* ---------- RESET ---------- */
$('resetBtn').onclick=()=>{
 $('contentSelect').selectedIndex=0;
 $('teamSelect').innerHTML='<option value="">-- choose --</option>';
 $('teamSelect').disabled=true;
 $('out').style.display='none';
};

/* ---------- IMAGE OVERLAY ---------- */
$('imgOverlay').onclick=e=>{
 if(e.target.id==='imgOverlay'||e.target.className==='close')
  $('imgOverlay').style.display='none';
};

/* ---------- DARK MODE ---------- */
$('modeToggle').onclick=()=>{
 document.body.classList.toggle('dark');
 $('modeToggle').textContent=
  document.body.classList.contains('dark')?'‚òÄÔ∏è Light Mode':'üåô Dark Mode';
};

/* ---------- AUTO START ---------- */
loadData();
</script>
</body>
</html>
